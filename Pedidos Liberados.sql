

--Consulta contagem de pedidos por dia.
select distinct C9_XLIBCRE, count(C9_XLIBCRE) as contagem
                    FROM ( SELECT	DISTINCT C9_PEDIDO,C9_XUSER,
                                    CONVERT(VARCHAR(10),CONVERT(DATE,C9_XLIBCRE,103),103) AS C9_XLIBCRE,
                                    C9_CLIENTE                 
                                    FROM SC9010
                                        WHERE	C9_XLIBCRE  >= '20230101'
                                            AND C9_XLIBCRE  <= '20231231'
                                            AND C9_ITEM     = '01'
                                            AND C9_FILIAL   IN ('010101', '010102', '010106')) as t1
											group by C9_XLIBCRE
											order by C9_XLIBCRE
											

--Consulta usada no fonte.
SELECT	DISTINCT 
				T1.C9_FILIAL,
				T1.C9_PEDIDO,
				C9_XUSER,
				T1.C9_XLIBCRE,
				T1.C9_CLIENTE
				FROM ( SELECT	DISTINCT 
								C9_FILIAL, 
								C9_PEDIDO,
								CONVERT(VARCHAR(10),CONVERT(DATE,C9_XLIBCRE,103),103) AS C9_XLIBCRE,
								C9_CLIENTE                 
								FROM SC9010
									WHERE	C9_XLIBCRE  >= '20230510'
										AND C9_XLIBCRE  <= '20230510'
										AND C9_ITEM     <> '' 
										AND C9_FILIAL   IN ('010101', '010102', '010106','030101')
										--AND C9_XUSER    IN ('GISLENER-TG', 'CAROLINER-TG','LARISSAS-TG','NATACHAM-TG')
										) AS T1
										LEFT JOIN SC9010 SC9 ON 1=1 
										AND T1.C9_FILIAL = SC9.C9_FILIAL
										AND T1.C9_PEDIDO = SC9.C9_PEDIDO 
										AND SC9.C9_CLIENTE = T1.C9_CLIENTE
										AND SC9.C9_XLIBCRE  >= '20230101'
										AND SC9.C9_XLIBCRE  <= '20230131'
										WHERE C9_XUSER <> ''
										AND C9_XUSER    IN ('GISLENER-TG', 'CAROLINER-TG','LARISSAS-TG','NATACHAM-TG')





--Consulta especificando cliente.
SELECT DISTINCT C9_PEDIDO,
            C9_XLIBCRE,
            C9_CLIENTE
            FROM ( SELECT	DISTINCT C9_PEDIDO,
                            CONVERT(VARCHAR(10),CONVERT(DATE,C9_XLIBCRE,103),103) AS C9_XLIBCRE,
                            C9_CLIENTE              
                            FROM SC9010 SC9 
							INNER JOIN SC6010 ON C9_FILIAL = C6_FILIAL and C9_PEDIDO = C6_NUM
                                WHERE	C9_XLIBCRE  >= '20220901'
                                    AND C9_BLCRED   IN ('','10')
                                    AND C9_FILIAL   = '010101'
									and C9_ITEM = '01'
									--AND C9_CLIENTE <> '017343'
									AND SC9.D_E_L_E_T_ = '') AS T1
									order by C9_XLIBCRE



--Consulta pedidos liberados por período 2023
SELECT 'Tegape_Matriz' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20230131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230201'
								AND C9_XLIBCRE  <= '20230231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230301'
								AND C9_XLIBCRE  <= '20230331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230401'
								AND C9_XLIBCRE  <= '20230431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230501'
								AND C9_XLIBCRE  <= '20230531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230601'
								AND C9_XLIBCRE  <= '20230631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230701'
								AND C9_XLIBCRE  <= '20230731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230801'
								AND C9_XLIBCRE  <= '20230831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230901'
								AND C9_XLIBCRE  <= '20230931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231001'
								AND C9_XLIBCRE  <= '20231031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231101'
								AND C9_XLIBCRE  <= '20231131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231201'
								AND C9_XLIBCRE  <= '20231231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20231231'
		) AS TOTAL_ANUAL

UNION ALL

SELECT 'Tecelagem' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20230131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230201'
								AND C9_XLIBCRE  <= '20230231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230301'
								AND C9_XLIBCRE  <= '20230331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230401'
								AND C9_XLIBCRE  <= '20230431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230501'
								AND C9_XLIBCRE  <= '20230531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230601'
								AND C9_XLIBCRE  <= '20230631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230701'
								AND C9_XLIBCRE  <= '20230731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230801'
								AND C9_XLIBCRE  <= '20230831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230901'
								AND C9_XLIBCRE  <= '20230931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231001'
								AND C9_XLIBCRE  <= '20231031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231101'
								AND C9_XLIBCRE  <= '20231131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231201'
								AND C9_XLIBCRE  <= '20231231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20231231'
		) AS TOTAL_ANUAL

UNION ALL

SELECT 'QFacil' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20230131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230201'
								AND C9_XLIBCRE  <= '20230231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230301'
								AND C9_XLIBCRE  <= '20230331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230401'
								AND C9_XLIBCRE  <= '20230431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230501'
								AND C9_XLIBCRE  <= '20230531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230601'
								AND C9_XLIBCRE  <= '20230631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230701'
								AND C9_XLIBCRE  <= '20230731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230801'
								AND C9_XLIBCRE  <= '20230831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230901'
								AND C9_XLIBCRE  <= '20230931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231001'
								AND C9_XLIBCRE  <= '20231031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231101'
								AND C9_XLIBCRE  <= '20231131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20231201'
								AND C9_XLIBCRE  <= '20231231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20230101'
								AND C9_XLIBCRE  <= '20231231'
		) AS TOTAL_ANUAL



--Consulta pedidos liberados por período 2024
SELECT 'Tegape_Matriz' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20230516 = '20230516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20240131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240201'
								AND C9_XLIBCRE  <= '20240231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240301'
								AND C9_XLIBCRE  <= '20240331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240401'
								AND C9_XLIBCRE  <= '20240431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240501'
								AND C9_XLIBCRE  <= '20240531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240601'
								AND C9_XLIBCRE  <= '20240631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240701'
								AND C9_XLIBCRE  <= '20240731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240801'
								AND C9_XLIBCRE  <= '20240831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240901'
								AND C9_XLIBCRE  <= '20240931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241001'
								AND C9_XLIBCRE  <= '20241031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241101'
								AND C9_XLIBCRE  <= '20241131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241201'
								AND C9_XLIBCRE  <= '20241231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010101'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20241231'
		) AS TOTAL_ANUAL

UNION ALL

SELECT 'Tecelagem' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20240131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240201'
								AND C9_XLIBCRE  <= '20240231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240301'
								AND C9_XLIBCRE  <= '20240331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240401'
								AND C9_XLIBCRE  <= '20240431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240501'
								AND C9_XLIBCRE  <= '20240531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240601'
								AND C9_XLIBCRE  <= '20240631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240701'
								AND C9_XLIBCRE  <= '20240731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240801'
								AND C9_XLIBCRE  <= '20240831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240901'
								AND C9_XLIBCRE  <= '20240931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241001'
								AND C9_XLIBCRE  <= '20241031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241101'
								AND C9_XLIBCRE  <= '20241131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241201'
								AND C9_XLIBCRE  <= '20241231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010102'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20241231'
		) AS TOTAL_ANUAL

UNION ALL

SELECT 'QFacil' AS EMPRESA,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20240131'
		) AS JANEIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240201'
								AND C9_XLIBCRE  <= '20240231'
		) AS FEVEREIRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240301'
								AND C9_XLIBCRE  <= '20240331'
		) AS MARÇO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240401'
								AND C9_XLIBCRE  <= '20240431'
		) AS ABRIL,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240501'
								AND C9_XLIBCRE  <= '20240531'
		) AS MAIO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240601'
								AND C9_XLIBCRE  <= '20240631'
		) AS JUNHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240701'
								AND C9_XLIBCRE  <= '20240731'
		) AS JULHO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240801'
								AND C9_XLIBCRE  <= '20240831'
		) AS AGOSTO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240901'
								AND C9_XLIBCRE  <= '20240931'
		) AS SETEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241001'
								AND C9_XLIBCRE  <= '20241031'
		) AS OUTUBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241101'
								AND C9_XLIBCRE  <= '20241131'
		) AS NOVEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20241201'
								AND C9_XLIBCRE  <= '20241231'
		) AS DEZEMBRO,
		(SELECT COUNT(DISTINCT C9_PEDIDO) FROM SC9010 WHERE C9_FILIAL = '010106'
								--AND C9_PEDIDO = '002426'
								--AND 20240516 = '20240516'
								AND C9_XLIBCRE  >= '20240101'
								AND C9_XLIBCRE  <= '20241231'
		) AS TOTAL_ANUAL



SELECT SUM(C2_QUJE) FROM SC2010 WHERE C2_PRODUTO IN (SELECT B1_COD FROM SB1010 WHERE B1_POSIPI like ('5911%')) AND YEAR(C2_DATRF) = '2023' AND C2_FILIAL = '020101' AND C2_UM = 'KG'


SELECT * FROM SC2010 WHERE C2_PRODUTO IN (SELECT B1_COD FROM SB1010 WHERE B1_POSIPI like ('5911%')) AND YEAR(C2_DATRF) = '2023' AND C2_FILIAL = '020101'


SELECT FT_TIPO,* FROM SFT010

