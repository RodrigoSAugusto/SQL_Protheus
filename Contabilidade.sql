

-- CONSULTA NOTAS DE ENTRADA POR PERÍODO ELIZIANE

	select '-','-', 'TOTAL', SUM(MARÇO) FROM
	(SELECT	A2_COD,
		A2_NREDUZ, 
		SUM(D1_TOTAL) AS MARÇO
			FROM SA2010
			INNER JOIN SD1010 SD1 ON A2_COD = D1_FORNECE AND D1_FILIAL = CONCAT('01',A2_FILIAL )
					WHERE A2_FILIAL = '0101'
					AND  MONTH(D1_DTDIGIT) = '3'
					AND YEAR(D1_DTDIGIT) = '2022'
					AND SD1.D_E_L_E_T_ = ''
					AND A2_COD in (
						'003968','004004','009821','011111','015527','032035','032040','032044','032046','032085',
						'032086','033018','033020','033063','035458','036252','036487','036561','036827','036880',
						'052275','052290','054573','056097','056561','056641','066499','067066','069806','070949',
						'072723','075955','076856','094149','094219','096144','096144','096144','096144','096144',
						'096254','103040','105312','106547','106548','108473','110760','111396','112060','112062',
						'112636','113619','113631','114838','115521','116945','117301','117925','117987','118207',
						'118227','118490','121436','888937','888962','888985','889018','889025','889074','889254',
						'889438','889443','889796','890026','890264','890631','890684','890755','890960','890961',
						'891100','891118','891123','891936','932852','934917','935160','934764','934866')
						GROUP BY A2_COD,A2_LOJA, A2_NREDUZ) AS T1



SELECT	A2_COD,
		A2_FILIAL,
		A2_NREDUZ,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '1' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS JAN,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '2' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS FEV,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '3' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS MAR,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '4' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS ABR,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '5' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS MAI,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '6' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS JUN,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '7' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS JUL,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '8' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS AGO,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '9' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS 'SET',
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '10' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS 'OUT',
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '11' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS NOV,
		(SELECT SUM(D1_TOTAL) FROM SD1010 WHERE D1_FILIAL in ('030101') AND YEAR(D1_DTDIGIT) = '2022' AND  MONTH(D1_DTDIGIT) = '12' AND D1_FORNECE = '004004' AND D_E_L_E_T_ = '')  AS DEZ
			
			FROM SA2010
			INNER JOIN SD1010 SD1 ON A2_COD = D1_FORNECE AND D1_FILIAL = CONCAT(TRIM(A2_FILIAL), '01') or D1_FILIAL = CONCAT(TRIM(A2_FILIAL), '02') or D1_FILIAL = CONCAT(TRIM(A2_FILIAL), '03') or D1_FILIAL = CONCAT(TRIM(A2_FILIAL), '04')
					WHERE SD1.D_E_L_E_T_ = ''
						and A2_FILIAL = '0301'
						AND A2_COD = '004004'
					GROUP BY A2_COD,A2_FILIAL, A2_NREDUZ


					select * 
					from SA2010 
					where D_E_L_E_T_ = ''
					and A2_FILIAL = '0301'
					AND A2_COD = '004004'
					order BY A2_FILIAL

					select * 
					from SD1010 
					where D_E_L_E_T_ = ''
					and D1_FILIAL = '030102'
					AND D1_FORNECE = '004004'
					order BY D1_FILIAL

	-- SELECT ESPECIFICO POR FORNECEDOR
	SELECT	D1_FILIAL, 
		D1_FORNECE, 
		D1_LOJA, 
		D1_DOC, 
		D1_ITEM, 
		CONVERT(VARCHAR(10),CONVERT(DATE,D1_EMISSAO,103),103) AS EMISSAO, 
		CONVERT(VARCHAR(10),CONVERT(DATE,D1_DTDIGIT,103),103) AS DTDIGIT,
		D1_COD, 
		D1_XDESCPR, 
		D1_TOTAL, 
		D1_TES,
		D1_CF, 
		D1_CONTA 
			FROM SD1010 
				WHERE D1_FORNECE = '004004' 
					AND D1_FILIAL = '010101'
					AND YEAR(D1_DTDIGIT) = '2022'
					AND D_E_L_E_T_ = ''
					order by D1_DTDIGIT


'000028','001756','015260','015843','015928','015946','015960','015975','015983','015986','016072',
'016082','016230','016236','016299','016408','016453','017148','017384','017384','019408','019884',
'021440','021707','022346','023363','024276','024435','024717','030227','032971','033246','033749',
'033753','034024','034596','035264','036936','037765','038423','038700','039216','039439','039831',
'039833','040088','040278','040381','041021','060955','060955','061017','112011','112012','112023',
'112029','112350','112407','353578','036937','061018',





