

BEGIN TRANSACTION

while ( 
SELECT MAX(M2_DATA) FROM SM2010
) <= '20221231'
BEGIN
INSERT INTO  SM2010 (M2_DATA, M2_MOEDA3, M2_INFORM, R_E_C_N_O_) VALUES ((SELECT 
SUBSTRING(CONVERT(VARCHAR(10),CONVERT(DATE,DATEADD(DAY,1,MAX(M2_DATA)),102),102),1,4) +
SUBSTRING(CONVERT(VARCHAR(10),CONVERT(DATE,DATEADD(DAY,1,MAX(M2_DATA)),102),102),6,2) +
SUBSTRING(CONVERT(VARCHAR(10),CONVERT(DATE,DATEADD(DAY,1,MAX(M2_DATA)),102),102),9,2)
FROM SM2010),0.8287,'s',(select MAX(R_E_C_N_O_) + 1 from SM2010))
END

COMMIT 

