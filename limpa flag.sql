--E1_LA - Títs. a Receber
--E2_LA - Títs. a Pagar
--E5_LA - Mov. Bancário

--000273384
--DECLARE @TITULO VARCHAR(20)='001-000273536'


--#########################################################
--VALIDA

select E1_LA,* 
--select sum(E1_VALLIQ)
--BEGIN TRANSACTION UPDATE SE1 SET E1_LA=''
from SE1010 SE1
WHERE 1=1
--AND E1_NUMBOR='000029'
AND (E1_PREFIXO+'-'+E1_NUM+'-'+E1_PARCELA IN(
'001-000275587',
'001-000275337-002',
'001-000021912-003',
'001-000022581-001')

OR E1_PREFIXO+'-'+E1_NUM IN(
'001-000275587',
'001-000275337-002',
'001-000021912-003',
'001-000022581-001')
)
AND D_E_L_E_T_=''
AND E1_LA<>'N'

--select E2_LA,* from SE2010 SE2
--WHERE (E2_PREFIXO+'-'+E2_NUM+'-'+E2_PARCELA =@TITULO OR E2_PREFIXO+'-'+E2_NUM =@TITULO)AND D_E_L_E_T_=''



select E5_LA,*
--select SUM(E5_VALOR)
--COUNT (*), E5_PREFIXO,E5_NUMERO,E5_PARCELA
--BEGIN TRANSACTION UPDATE SE5 SET E5_LA=''
from SE5010 SE5
WHERE 1=1
AND (E5_PREFIXO+'-'+E5_NUMERO+'-'+E5_PARCELA IN(
'001-000275587',
'001-000275337-002',
'001-000021912-003',
'001-000022581-001')

OR E5_PREFIXO+'-'+E5_NUMERO IN(
'001-000275587',
'001-000275337-002',
'001-000021912-003',
'001-000022581-001')
) AND D_E_L_E_T_=''
AND E5_TIPODOC ='VL'
AND E5_LA<>'N'
--GROUP BY E5_PREFIXO,E5_NUMERO,E5_PARCELA


--#################################################

--UPDATE
/*
DECLARE @TITULO VARCHAR(20)='001-000273536'
BEGIN TRANSACTION UPDATE SE1 SET E1_LA=''
from SE1010 SE1
WHERE (E1_PREFIXO+'-'+E1_NUM+'-'+E1_PARCELA =@TITULO OR E1_PREFIXO+'-'+E1_NUM =@TITULO)AND D_E_L_E_T_=''

--BEGIN TRANSACTION UPDATE SE2 SET E2_LA=''
--from SE2010 SE2
--WHERE (E2_PREFIXO+'-'+E2_NUM+'-'+E2_PARCELA =@TITULO OR E2_PREFIXO+'-'+E2_NUM =@TITULO)AND D_E_L_E_T_=''

BEGIN TRANSACTION UPDATE SE5 SET E5_LA=''
from SE5010 SE5
WHERE (E5_PREFIXO+'-'+E5_NUMERO+'-'+E5_PARCELA =@TITULO OR E5_PREFIXO+'-'+E5_NUMERO=@TITULO) AND D_E_L_E_T_=''
*/

--commit	
--ROLLBACK

--001-000086976
--001-000087124-001

select E1_LA, *
--BEGIN TRANSACTION UPDATE SE1 SET E1_LA=''
from SE1010 SE1
WHERE 1=1
--and (E1_PREFIXO+'-'+E1_NUM+'-'+E1_PARCELA IN('S-000809-002') OR E1_PREFIXO+'-'+E1_NUM IN('S-000809-002'))AND D_E_L_E_T_=''
AND E1_VALOR= 5232.50
--AND E1_LA ='S'
--AND E1_TIPO='RA'
--AND E1_NUM='080120002'
--AND E1_PREFIXO='001'
AND E1_NUM='000271472'
--002709001
--000271236
--000271472

--AND E1_PARCELA='002'

select *
from SE2010 SE2
WHERE 1=1
--and (E2_EMIS1 between '20200401' and '20200430')
--AND E2_FILIAL ='010101'
--AND E2_LOTE='8850'
AND E2_NUM='000021378'
--or E2_VENCTO between '20200401' and '20200430')
--and (E2_PREFIXO+'-'+E2_NUM+'-'+E2_PARCELA =@TITULO OR E2_PREFIXO+'-'+E2_NUM =@TITULO)AND D_E_L_E_T_=''



SELECT E5_LA,*
--BEGIN TRANSACTION UPDATE SE5 SET E5_LA=''
from SE5010 SE5
WHERE 1=1
--AND (E5_PREFIXO+'-'+E5_NUMERO+'-'+E5_PARCELA IN('S-000809-002')
--OR E5_PREFIXO+'-'+E5_NUMERO IN('S-000809-002'))
----AND D_E_L_E_T_=''
----AND E5_LA<>'N'
--AND E5_TIPODOC ='RA'
AND E5_VALOR=5232.50
--AND E5_NUMERO='080120002'
--AND E5_PREFIXO ='001'
AND E5_NUMERO ='000271472'
--AND E5_PARCELA ='002'
--AND E5_SEQ ='02'


