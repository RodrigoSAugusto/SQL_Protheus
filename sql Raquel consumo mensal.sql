

--SELECT * FROM SD1010 WHERE D1_FILIAL = '020101' AND D1_COD = '007052'

--SELECT * FROM SD2010 WHERE D2_FILIAL = '020101' AND D2_COD = '007052'

--SELECT * FROM SD3010 WHERE D3_FILIAL = '020101' AND D3_COD = '007052'


SELECT * FROM (

SELECT	CONVERT(DATE,D1_EMISSAO,103) AS 'DATA', 'Entrada' AS TIPO, D1_PEDIDO AS 'PEDIDO/OP', 
		D1_COD AS CODIGO, D1_DOC AS NF, 
		D1_FORNECE AS FORNECEDOR, CONVERT(VARCHAR(10),D1_QUANT,103) AS Quantidade, 
		CONVERT(VARCHAR(10),D1_TOTAL,103) AS VALOR_TOTAL 
		FROM SD1010 
			WHERE	D1_FILIAL = '020101'
				AND D1_COD = '007052'
				AND D1_EMISSAO >= '20200101'
				AND D1_EMISSAO <= '20220930'

		UNION ALL

SELECT	CONVERT(DATE,D2_EMISSAO,103), 'Saida' , D2_PEDIDO , 
		D2_COD , D2_DOC, 
		D2_CLIENTE ,
		CONVERT(VARCHAR(10),D2_QUANT,103) , CONVERT(VARCHAR(10),D2_TOTAL,103)
		FROM SD2010 
			WHERE	D2_FILIAL = '020101'
				AND D2_COD = '007052'
				AND D2_EMISSAO >= '20200101'
				AND D2_EMISSAO <= '20220930'

		UNION ALL

SELECT	CONVERT(DATE,D3_EMISSAO,103) , D3_TM , D3_OP , 
		D3_COD , D3_DOC, 
		D3_USUARIO ,
		CONVERT(VARCHAR(10),D3_QUANT,103) , CONVERT(VARCHAR(10),D3_CUSTO1,103)
		FROM SD3010 
			WHERE	D3_FILIAL = '020101'
				AND D3_COD = '007052'
				AND D3_EMISSAO >= '20200101'
				AND D3_EMISSAO <= '20220930'

		UNION ALL

SELECT CONVERT(DATE,GETDATE(),103),'','','','','SALDO ATUAL ->',B2_QATU, B2_VFIM1  FROM SB2010 WHERE	B2_FILIAL = '020101' AND B2_COD = '007052') AS T1 ORDER BY 'DATA'




--SELECT * FROM SB2010 WHERE B2_FILIAL = '020101' AND B2_COD = '007052'




